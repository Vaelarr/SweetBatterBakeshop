# ğŸ—ºï¸ Database Schema Diagram

## Entity Relationship Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SWEETBATTERBAKESHOP DATABASE SCHEMA                     â”‚
â”‚                              Version 2.0                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      INVENTORY            â”‚         â”‚  INVENTORY_STOCK_HISTORY  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PK  id                    â”‚â”€â”€â”€â”€â”    â”‚ PK  id                    â”‚
â”‚ UQ  name                  â”‚    â”‚    â”‚ FK  item_name             â”‚â—„â”€â”€â”
â”‚     category              â”‚    â”‚    â”‚     old_quantity          â”‚   â”‚
â”‚     price                 â”‚    â”‚    â”‚     new_quantity          â”‚   â”‚
â”‚     stock_quantity        â”‚    â”‚    â”‚     change_amount         â”‚   â”‚
â”‚     min_stock_level       â”‚    â”‚    â”‚     change_type (ENUM)    â”‚   â”‚
â”‚     expiration_date       â”‚    â”‚    â”‚     notes                 â”‚   â”‚
â”‚ UQ  barcode               â”‚    â”‚    â”‚     changed_by            â”‚   â”‚
â”‚     supplier              â”‚    â”‚    â”‚     changed_at            â”‚   â”‚
â”‚     description           â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     image_path            â”‚    â”‚                                    â”‚
â”‚     is_active             â”‚    â”‚                                    â”‚
â”‚     created_at            â”‚    â”‚                                    â”‚
â”‚     updated_at            â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚   SALES_ITEMS             â”‚   â”‚
        â”‚                         â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
        â”‚                         â”‚    â”‚ PK  id                    â”‚   â”‚
        â”‚ Referenced by           â”‚    â”‚ FK  transaction_id        â”‚â”€â”€â”€â”¼â”€â”€â”
        â”‚ sales_items.item_name   â”‚    â”‚     item_name (ref inv)   â”‚   â”‚  â”‚
        â”‚                         â”‚    â”‚     category              â”‚   â”‚  â”‚
        â–¼                         â”‚    â”‚     price                 â”‚   â”‚  â”‚
                                  â”‚    â”‚     quantity              â”‚   â”‚  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚     subtotal              â”‚   â”‚  â”‚
â”‚   SALES_TRANSACTIONS      â”‚    â”‚    â”‚     discount_amount       â”‚   â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ PK  id                    â”‚    â”‚                â–²                   â”‚  â”‚
â”‚ UQ  transaction_id        â”‚â—„â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚
â”‚     transaction_date      â”‚    â”‚                                    â”‚  â”‚
â”‚     subtotal              â”‚    â”‚                                    â”‚  â”‚
â”‚     discount_amount       â”‚    â”‚                                    â”‚  â”‚
â”‚     tax_amount            â”‚    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚     total                 â”‚    â”‚    â”‚  DAILY_SALES_SUMMARY      â”‚   â”‚  â”‚
â”‚     payment_method (ENUM) â”‚    â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚     payment_amount        â”‚    â”‚    â”‚ PK  id                    â”‚   â”‚  â”‚
â”‚     change_amount         â”‚    â”‚    â”‚ UQ  summary_date          â”‚   â”‚  â”‚
â”‚     discount_applied      â”‚    â”‚    â”‚     total_transactions    â”‚   â”‚  â”‚
â”‚     discount_type         â”‚    â”‚    â”‚     total_items_sold      â”‚   â”‚  â”‚
â”‚     customer_type (ENUM)  â”‚    â”‚    â”‚     gross_sales           â”‚   â”‚  â”‚
â”‚     served_by             â”‚    â”‚    â”‚     total_discounts       â”‚   â”‚  â”‚
â”‚     notes                 â”‚    â”‚    â”‚     total_tax             â”‚   â”‚  â”‚
â”‚     created_at            â”‚    â”‚    â”‚     net_sales             â”‚   â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚     cash_sales            â”‚   â”‚  â”‚
                                  â”‚    â”‚     ecash_sales           â”‚   â”‚  â”‚
                                  â”‚    â”‚     card_sales            â”‚   â”‚  â”‚
                                  â”‚    â”‚     avg_transaction_value â”‚   â”‚  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚     created_at            â”‚   â”‚  â”‚
â”‚     ADMIN_USERS           â”‚    â”‚    â”‚     updated_at            â”‚   â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ PK  id                    â”‚    â”‚                                    â”‚  â”‚
â”‚ UQ  username              â”‚â—„â”€â”€â”€â”¼â”€â”€â”€â”€â”                               â”‚  â”‚
â”‚     password_hash         â”‚    â”‚    â”‚                               â”‚  â”‚
â”‚     full_name             â”‚    â”‚    â”‚                               â”‚  â”‚
â”‚ UQ  email                 â”‚    â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚     role (ENUM)           â”‚    â”‚    â”‚   â”‚ PRODUCT_SALES_        â”‚   â”‚  â”‚
â”‚     phone                 â”‚    â”‚    â”‚   â”‚ ANALYTICS             â”‚   â”‚  â”‚
â”‚     created_at            â”‚    â”‚    â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚     last_login            â”‚    â”‚    â”‚   â”‚ PK  id                â”‚   â”‚  â”‚
â”‚     is_active             â”‚    â”‚    â”‚   â”‚     item_name         â”‚   â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚   â”‚     category          â”‚   â”‚  â”‚
        â”‚                         â”‚    â”‚   â”‚     analysis_period   â”‚   â”‚  â”‚
        â”‚                         â”‚    â”‚   â”‚     period_start_date â”‚   â”‚  â”‚
        â”‚                         â”‚    â”‚   â”‚     period_end_date   â”‚   â”‚  â”‚
        â–¼                         â”‚    â”‚   â”‚     units_sold        â”‚   â”‚  â”‚
                                  â”‚    â”‚   â”‚     total_revenue     â”‚   â”‚  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚   â”‚     avg_price         â”‚   â”‚  â”‚
â”‚  ADMIN_ACTIVITY_LOG       â”‚    â”‚    â”‚   â”‚     created_at        â”‚   â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ PK  id                    â”‚    â”‚    â”‚                               â”‚  â”‚
â”‚ FK  admin_username        â”‚â”€â”€â”€â”€â”˜    â”‚                               â”‚  â”‚
â”‚     action_type           â”‚         â”‚                               â”‚  â”‚
â”‚     action_description    â”‚         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚     affected_table        â”‚         â”‚   â”‚  SYSTEM_SETTINGS      â”‚   â”‚  â”‚
â”‚     affected_record_id    â”‚         â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚  â”‚
â”‚     ip_address            â”‚         â”‚   â”‚ PK  id                â”‚   â”‚  â”‚
â”‚     created_at            â”‚         â”‚   â”‚ UQ  setting_key       â”‚   â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚     setting_value     â”‚   â”‚  â”‚
                                      â”‚   â”‚     setting_type      â”‚   â”‚  â”‚
                                      â”‚   â”‚     description       â”‚   â”‚  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚     updated_by        â”‚   â”‚  â”‚
â”‚     HELP_REQUESTS         â”‚         â”‚   â”‚     updated_at        â”‚   â”‚  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚ PK  id                    â”‚         â”‚                               â”‚  â”‚
â”‚ UQ  request_id            â”‚         â”‚                               â”‚  â”‚
â”‚     location              â”‚         â”‚                               â”‚  â”‚
â”‚     request_type          â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     description           â”‚                                            â”‚
â”‚     priority (ENUM)       â”‚                                            â”‚
â”‚     status (ENUM)         â”‚                                            â”‚
â”‚ FK  assigned_to           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ FK  resolved_by           â”‚
â”‚     created_at            â”‚
â”‚     resolved_at           â”‚
â”‚     resolution_notes      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Database Views (Read-Only)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATABASE VIEWS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  v_today_sales      â”‚      â”‚  v_top_products     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ total_transactions  â”‚      â”‚ item_name           â”‚
â”‚ total_sales         â”‚      â”‚ category            â”‚
â”‚ total_discounts     â”‚      â”‚ total_sold          â”‚
â”‚ avg_transaction     â”‚      â”‚ total_revenue       â”‚
â”‚ cash_sales          â”‚      â”‚ avg_price           â”‚
â”‚ ecash_sales         â”‚      â”‚ transaction_count   â”‚
â”‚ senior_pwd_count    â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
        â”‚                            â”‚
        â”‚ Source: sales_transactions â”‚
        â”‚         + sales_items      â”‚ Source: sales_items
        â”‚                            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  v_low_stock_items  â”‚      â”‚  v_expired_items    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ name                â”‚      â”‚ name                â”‚
â”‚ category            â”‚      â”‚ category            â”‚
â”‚ stock_quantity      â”‚      â”‚ stock_quantity      â”‚
â”‚ min_stock_level     â”‚      â”‚ expiration_date     â”‚
â”‚ stock_deficit       â”‚      â”‚ days_expired        â”‚
â”‚ supplier            â”‚      â”‚ value_lost          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                            â”‚
        â”‚ Source: inventory          â”‚
        â”‚ WHERE: stock < min         â”‚ Source: inventory
        â”‚                            â”‚ WHERE: expired < today
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  v_expiring_soon    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ name                â”‚
â”‚ category            â”‚
â”‚ stock_quantity      â”‚
â”‚ expiration_date     â”‚
â”‚ days_until_expirationâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Source: inventory
        â”‚ WHERE: expires within 7 days
        â–¼
```

---

## Stored Procedures

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     STORED PROCEDURES                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  update_daily_sales_summary(DATE)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:  target_date                â”‚
â”‚ ACTION: Aggregates sales data      â”‚
â”‚ OUTPUT: Inserts/updates summary    â”‚
â”‚ TABLES: sales_transactions         â”‚
â”‚         sales_items                â”‚
â”‚         â†’ daily_sales_summary      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  record_stock_change(params)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:  item_name, old_qty,        â”‚
â”‚         new_qty, type, notes, user â”‚
â”‚ ACTION: Logs inventory change      â”‚
â”‚ OUTPUT: Inserts history record     â”‚
â”‚ TABLES: â†’ inventory_stock_history  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  generate_test_sales()             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:  None                       â”‚
â”‚ ACTION: Generates 30 days of data  â”‚
â”‚ OUTPUT: Inserts test transactions  â”‚
â”‚ TABLES: â†’ sales_transactions       â”‚
â”‚         â†’ sales_items              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  cleanup_test_data()               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ INPUT:  None                       â”‚
â”‚ ACTION: Removes all test data      â”‚
â”‚ OUTPUT: Deletes test records       â”‚
â”‚ TABLES: sales_*, inventory_history â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Triggers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          TRIGGERS                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  trg_inventory_stock_update        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ WHEN:   AFTER UPDATE ON inventory  â”‚
â”‚ IF:     stock_quantity changes     â”‚
â”‚ ACTION: Auto-logs to history       â”‚
â”‚ TABLES: inventory â†’ stock_history  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Indexes Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PERFORMANCE INDEXES                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

inventory:
  â”œâ”€ PRIMARY KEY (id)
  â”œâ”€ UNIQUE (name)
  â”œâ”€ UNIQUE (barcode)
  â”œâ”€ INDEX (category)
  â”œâ”€ INDEX (expiration_date)
  â”œâ”€ INDEX (stock_quantity)
  â”œâ”€ INDEX (is_active)
  â””â”€ INDEX (name)

sales_transactions:
  â”œâ”€ PRIMARY KEY (id)
  â”œâ”€ UNIQUE (transaction_id)
  â”œâ”€ INDEX (transaction_date)
  â”œâ”€ INDEX (payment_method)
  â”œâ”€ INDEX (customer_type)
  â””â”€ INDEX (created_at)

sales_items:
  â”œâ”€ PRIMARY KEY (id)
  â”œâ”€ INDEX (transaction_id)
  â”œâ”€ INDEX (item_name)
  â””â”€ INDEX (category)

admin_users:
  â”œâ”€ PRIMARY KEY (id)
  â”œâ”€ UNIQUE (username)
  â”œâ”€ UNIQUE (email)
  â”œâ”€ INDEX (role)
  â””â”€ INDEX (is_active)

help_requests:
  â”œâ”€ PRIMARY KEY (id)
  â”œâ”€ UNIQUE (request_id)
  â”œâ”€ INDEX (status)
  â”œâ”€ INDEX (priority)
  â”œâ”€ INDEX (created_at)
  â””â”€ INDEX (assigned_to)
```

---

## Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   KIOSK OPERATION FLOW                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. CUSTOMER SHOPPING
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Browse      â”‚ â†’ Query: SELECT * FROM inventory 
   â”‚  Products    â”‚          WHERE is_active = TRUE
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. ADD TO CART
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Select Item â”‚ â†’ In-Memory: CartManager
   â”‚  & Quantity  â”‚   (Java Application)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. CHECKOUT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Apply Promo â”‚ â†’ Calculate: discount_amount
   â”‚  Code & Tax  â”‚   tax_amount = (subtotal - discount) * 0.12
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Process     â”‚ â†’ INSERT INTO sales_transactions
   â”‚  Payment     â”‚   INSERT INTO sales_items (multiple)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Update      â”‚ â†’ UPDATE inventory 
   â”‚  Stock       â”‚   SET stock_quantity = stock_quantity - ?
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   (Triggers stock_history insert)

4. ADMIN MONITORING
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Dashboard   â”‚ â†’ SELECT FROM v_today_sales
   â”‚  Stats       â”‚   SELECT COUNT(*) FROM v_low_stock_items
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Sales       â”‚ â†’ SELECT FROM sales_transactions
   â”‚  Reports     â”‚   WHERE DATE(transaction_date) = ?
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Inventory   â”‚ â†’ SELECT FROM v_low_stock_items
   â”‚  Alerts      â”‚   SELECT FROM v_expired_items
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5. CUSTOMER SUPPORT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Help Button â”‚ â†’ INSERT INTO help_requests
   â”‚  Pressed     â”‚   (status = 'PENDING')
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Admin       â”‚ â†’ UPDATE help_requests
   â”‚  Responds    â”‚   SET status = 'RESOLVED'
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

6. END OF DAY
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Automated   â”‚ â†’ CALL update_daily_sales_summary(CURDATE())
   â”‚  Summary     â”‚   (Creates aggregated report)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Foreign Key Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  REFERENTIAL INTEGRITY                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

inventory.name â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚
inventory_stock_history.item_name (FK, CASCADE DELETE)
                              â”‚
                              â””â”€ When product deleted, 
                                 history is also deleted


sales_transactions.transaction_id â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚
sales_items.transaction_id (FK, CASCADE DELETE)
                                              â”‚
                                              â””â”€ When transaction deleted,
                                                 all items are deleted


admin_users.username â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                       â”‚
admin_activity_log.admin_username (FK, CASCADE DELETE)
help_requests.assigned_to (FK, SET NULL)
help_requests.resolved_by (FK, SET NULL)
                                       â”‚
                                       â””â”€ When admin deleted,
                                          logs deleted,
                                          assignments nullified
```

---

## Enum Types

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ENUMERATION TYPES                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

inventory_stock_history.change_type:
  â€¢ SALE - Sold to customer
  â€¢ RESTOCK - New stock received
  â€¢ ADJUSTMENT - Manual correction
  â€¢ EXPIRED - Removed due to expiration
  â€¢ DAMAGED - Removed due to damage

sales_transactions.payment_method:
  â€¢ CASH - Cash payment
  â€¢ ECASH - E-wallet payment
  â€¢ CARD - Credit/Debit card
  â€¢ OTHER - Other payment methods

sales_transactions.customer_type:
  â€¢ REGULAR - Standard customer
  â€¢ SENIOR - Senior citizen (20% discount)
  â€¢ PWD - Person with disability (20% discount)
  â€¢ EMPLOYEE - Staff member

admin_users.role:
  â€¢ SUPER_ADMIN - Full system access
  â€¢ ADMIN - Inventory + reports
  â€¢ MANAGER - Reports + support
  â€¢ STAFF - Limited read access

help_requests.priority:
  â€¢ LOW - Can wait
  â€¢ MEDIUM - Normal priority
  â€¢ HIGH - Important
  â€¢ URGENT - Critical issue

help_requests.status:
  â€¢ PENDING - Awaiting response
  â€¢ IN_PROGRESS - Being handled
  â€¢ RESOLVED - Completed
  â€¢ CANCELLED - No longer needed

product_sales_analytics.analysis_period:
  â€¢ DAILY - Daily analysis
  â€¢ WEEKLY - Weekly rollup
  â€¢ MONTHLY - Monthly rollup
  â€¢ YEARLY - Yearly rollup
```

---

**Schema Version:** 2.0  
**Last Updated:** 2024  
**Total Tables:** 10  
**Total Views:** 5  
**Total Procedures:** 4  
**Total Triggers:** 1
